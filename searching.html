
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Package Searching &#8212; Common Package Specification v0.9.1</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/cps.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    
    <link rel="shortcut icon" href="_static/cps-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Supplemental Schema" href="schema-supplement.html" />
    <link rel="prev" title="Package Configurations" href="configurations.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="schema-supplement.html" title="Supplemental Schema"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="configurations.html" title="Package Configurations"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Common Package Specification v0.9.1</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Package Searching</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="package-searching">
<h1>Package Searching<a class="headerlink" href="#package-searching" title="Permalink to this heading">¶</a></h1>
<p>Tools shall locate a package
by searching for a file
<code class="code var docutils literal notranslate"><span class="pre">name</span></code><code class="code path docutils literal notranslate"><span class="pre">.cps</span></code>
in the following paths:</p>
<ul class="simple">
<li><p><code class="code var docutils literal notranslate"><span class="pre">prefix</span></code><code class="code path docutils literal notranslate"><span class="pre">/cps/</span></code>
<span class="applies-to">(Windows)</span></p></li>
<li><p><code class="code var docutils literal notranslate"><span class="pre">prefix</span></code><code class="code path docutils literal notranslate"><span class="pre">/cps/</span></code><code class="code var docutils literal notranslate"><span class="pre">name-like</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code>
<span class="applies-to">(Windows)</span></p></li>
<li><p><code class="code var docutils literal notranslate"><span class="pre">prefix</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code><code class="code var docutils literal notranslate"><span class="pre">name</span></code><code class="code path docutils literal notranslate"><span class="pre">.framework/Versions/</span></code><code class="code glob docutils literal notranslate"><span class="pre">*</span></code><code class="code path docutils literal notranslate"><span class="pre">/Resources/CPS/</span></code>
<span class="applies-to">(macOS)</span></p></li>
<li><p><code class="code var docutils literal notranslate"><span class="pre">prefix</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code><code class="code var docutils literal notranslate"><span class="pre">name</span></code><code class="code path docutils literal notranslate"><span class="pre">.framework/Resources/CPS/</span></code>
<span class="applies-to">(macOS)</span></p></li>
<li><p><code class="code var docutils literal notranslate"><span class="pre">prefix</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code><code class="code var docutils literal notranslate"><span class="pre">name</span></code><code class="code path docutils literal notranslate"><span class="pre">.app/Contents/Resources/CPS/</span></code>
<span class="applies-to">(macOS)</span></p></li>
<li><p><code class="code var docutils literal notranslate"><span class="pre">prefix</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code><code class="code var docutils literal notranslate"><span class="pre">libdir</span></code><code class="code path docutils literal notranslate"><span class="pre">/cps/</span></code><code class="code var docutils literal notranslate"><span class="pre">name-like</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code></p></li>
<li><p><code class="code var docutils literal notranslate"><span class="pre">prefix</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code><code class="code var docutils literal notranslate"><span class="pre">libdir</span></code><code class="code path docutils literal notranslate"><span class="pre">/cps/</span></code></p></li>
<li><p><code class="code var docutils literal notranslate"><span class="pre">prefix</span></code><code class="code path docutils literal notranslate"><span class="pre">/share/cps/</span></code><code class="code var docutils literal notranslate"><span class="pre">name-like</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code></p></li>
<li><p><code class="code var docutils literal notranslate"><span class="pre">prefix</span></code><code class="code path docutils literal notranslate"><span class="pre">/share/cps/</span></code></p></li>
</ul>
<p>The various placeholders are as follows:</p>
<dl>
<dt><code class="code var docutils literal notranslate"><span class="pre">name</span></code>:</dt><dd><p>The name of the package to be located,
including both the proper case name,
and the name converted to lower case.</p>
</dd>
<dt><code class="code var docutils literal notranslate"><span class="pre">name-like</span></code>:</dt><dd><p>Any of
<code class="code var docutils literal notranslate"><span class="pre">name</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code><code class="code glob docutils literal notranslate"><span class="pre">*</span></code>,
<code class="code var docutils literal notranslate"><span class="pre">name</span></code><code class="code path docutils literal notranslate"><span class="pre">-</span></code><code class="code glob docutils literal notranslate"><span class="pre">*</span></code>, or
<code class="code var docutils literal notranslate"><span class="pre">name</span></code>,
where <code class="code var docutils literal notranslate"><span class="pre">name</span></code>: is as previously defined,
and the asterisk (<code class="docutils literal notranslate"><span class="pre">*</span></code>) is one or more
valid filename characters, excluding the path separator.
This is intended to allow multiple versions of a package
to be installed into the same <code class="code var docutils literal notranslate"><span class="pre">prefix</span></code>.</p>
</dd>
<dt><code class="code var docutils literal notranslate"><span class="pre">libdir</span></code>:</dt><dd><p>The platform defined directories, sans root prefix,
in which matching architecture
and/or architecture-neutral libraries reside
(e.g. <code class="code path docutils literal notranslate"><span class="pre">lib</span></code>, <code class="code path docutils literal notranslate"><span class="pre">lib32</span></code>, <code class="code path docutils literal notranslate"><span class="pre">lib64</span></code>,
<code class="code path docutils literal notranslate"><span class="pre">lib/x86_64-linux-gnu</span></code>…).</p>
</dd>
<dt><code class="code var docutils literal notranslate"><span class="pre">prefix</span></code>:</dt><dd><p>One of the set of default install prefixes to be searched,
which shall include, at minimum and in order,
the set of paths (separated by <code class="code path docutils literal notranslate"><span class="pre">;</span></code> on Windows, <code class="code path docutils literal notranslate"><span class="pre">:</span></code> otherwise)
in the environment variable <code class="code env docutils literal notranslate"><span class="pre">CPS_PATH</span></code>,
<code class="code path docutils literal notranslate"><span class="pre">/usr/local</span></code>, and <code class="code path docutils literal notranslate"><span class="pre">/usr</span></code>.</p>
<p>In addition,
for all such package-neutral prefixes <code class="code var docutils literal notranslate"><span class="pre">prefix-root</span></code>,
the package-specific prefixes
<code class="code var docutils literal notranslate"><span class="pre">prefix-root</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code><code class="code var docutils literal notranslate"><span class="pre">name-like</span></code>
shall also be considered.</p>
</dd>
</dl>
<p>The complete list of search paths, above,
shall be considered in the order specified above,
for each prefix, before the next prefix is searched.
Package-specific prefixes shall be searched
before package-neutral prefixes.</p>
<p>It is recommended that tools should also provide
a mechanism for specifying the path to a specific CPS
which may be used to override the default search,
or to provide the location of a package
which is not installed to any of the standard search paths.</p>
<p>When a candidate <code class="docutils literal notranslate"><span class="pre">.cps</span></code> file is found,
the tool shall inspect the package’s <a class="reference internal" href="schema.html#platform"><span class="std std-ref">Platform</span></a>.
If the package’s platform does not match the target platform,
the tool should ignore the <code class="docutils literal notranslate"><span class="pre">.cps</span></code> and continue the search.
This allows for the installation of packages for different platforms
(e.g. 32- and 64-bit builds) on a single machine.
(Note that it is up to the tool to determine
what constitutes a matching platform.)
Similarly, if the package’s version
does not satisfy the required version
as specified by the user,
the tool should continue searching.
(In both cases, the tool may wish
to make note of the incompatible packages,
and the reason for rejection.)</p>
<section id="prefix-determination">
<h2>Prefix Determination<a class="headerlink" href="#prefix-determination" title="Permalink to this heading">¶</a></h2>
<p>In order to determine the package prefix,
which may appear in various attributes as <code class="docutils literal notranslate"><span class="pre">&#64;prefix&#64;</span></code>,
it is necessary to determine the effective prefix
from the canonical location of the <code class="docutils literal notranslate"><span class="pre">.cps</span></code> file.
This can be accomplished in three ways:</p>
<ul class="simple">
<li><p>If the package specifies a <code class="code attribute docutils literal notranslate"><span class="pre">Cps-Path</span></code>,
that value shall be used.</p></li>
<li><p>Otherwise, if the tool has just completed a search
for the <code class="docutils literal notranslate"><span class="pre">.cps</span></code>, as described above,
the prefix is known from the path which was searched.</p></li>
<li><p>Otherwise, the prefix shall be deduced as follows:</p>
<ul>
<li><p>The path is initially taken to be the directory portion
(i.e. without file name) of the absolute path to the <code class="docutils literal notranslate"><span class="pre">.cps</span></code> file.</p></li>
<li><p><span class="applies-to">(macOS)</span>
If the tail-portion matches
<code class="code path docutils literal notranslate"><span class="pre">/Resources/</span></code> or <code class="code path docutils literal notranslate"><span class="pre">/Resources/CPS/</span></code>,
then:</p>
<ul>
<li><p>The matching portion is removed.</p></li>
<li><p>If the tail-portion of the remaining path
matches <code class="code path docutils literal notranslate"><span class="pre">/Versions/</span></code><code class="code glob docutils literal notranslate"><span class="pre">*</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code>,
that portion is removed.</p></li>
<li><p>If the tail-portion of the remaining path matches
<code class="code path docutils literal notranslate"><span class="pre">/</span></code><code class="code var docutils literal notranslate"><span class="pre">name</span></code><code class="code path docutils literal notranslate"><span class="pre">.framework/</span></code> or
<code class="code path docutils literal notranslate"><span class="pre">/</span></code><code class="code var docutils literal notranslate"><span class="pre">name</span></code><code class="code path docutils literal notranslate"><span class="pre">.app/Contents/</span></code>,
that portion is removed.</p></li>
</ul>
</li>
<li><p>Otherwise:</p>
<ul>
<li><p>If the tail-portion of the path matches
<code class="code path docutils literal notranslate"><span class="pre">/cps/</span></code><code class="code var docutils literal notranslate"><span class="pre">name-like</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code> or
<code class="code path docutils literal notranslate"><span class="pre">/cps/</span></code>,
that portion is removed.</p></li>
<li><p>If the tail-portion of the remaining path matches any of
<code class="code path docutils literal notranslate"><span class="pre">/</span></code><code class="code var docutils literal notranslate"><span class="pre">libdir</span></code><code class="code path docutils literal notranslate"><span class="pre">/</span></code> or <code class="code path docutils literal notranslate"><span class="pre">/share/</span></code>,
that portion is removed.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development Process</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="schema.html">Package Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Compiler and Linker Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Component Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="configurations.html">Package Configurations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Package Searching</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prefix-determination">Prefix Determination</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="schema-supplement.html">Supplemental Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="recommendations.html">Usage and Implementation Recommendations</a></li>
<li class="toctree-l1"><a class="reference internal" href="sample.html">Sample CPS File</a></li>
</ul>

  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="configurations.html"
                          title="previous chapter">Package Configurations</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="schema-supplement.html"
                          title="next chapter">Supplemental Schema</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/searching.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="schema-supplement.html" title="Supplemental Schema"
             >next</a> |</li>
        <li class="right" >
          <a href="configurations.html" title="Package Configurations"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Common Package Specification v0.9.1</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Package Searching</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Matthew Woehlke.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>